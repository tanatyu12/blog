{"version":3,"sources":["../../../src/actions/entries.js"],"names":["notifSend","notifActions","ENTRY_REQUEST","ENTRY_SUCCESS","ENTRY_FAILURE","ENTRIES_REQUEST","ENTRIES_SUCCESS","ENTRIES_FAILURE","DRAFT_CREATE_FROM_ENTRY","DRAFT_CREATE_EMPTY","DRAFT_DISCARD","DRAFT_CHANGE","DRAFT_CHANGE_FIELD","DRAFT_VALIDATION_ERRORS","DRAFT_CLEAR_ERRORS","DRAFT_LOCAL_BACKUP_RETRIEVED","DRAFT_CREATE_FROM_LOCAL_BACKUP","ENTRY_PERSIST_REQUEST","ENTRY_PERSIST_SUCCESS","ENTRY_PERSIST_FAILURE","ENTRY_DELETE_REQUEST","ENTRY_DELETE_SUCCESS","ENTRY_DELETE_FAILURE","entryLoading","collection","slug","type","payload","get","entryLoaded","entry","entryLoadError","error","entriesLoading","entriesLoaded","entries","pagination","cursor","append","page","Cursor","create","entriesFailed","toString","meta","entryPersisting","collectionName","entrySlug","entryPersisted","entryPersistFail","entryDeleting","entryDeleted","entryDeleteFail","emptyDraftCreated","createDraftFromEntry","metadata","discardDraft","changeDraft","changeDraftField","field","value","changeDraftFieldValidation","uniquefieldId","errors","clearFieldErrors","localBackupRetrieved","loadLocalBackup","persistLocalBackup","dispatch","getState","state","backend","config","persistLocalDraftBackup","retrieveLocalBackup","getLocalDraftBackup","deleteLocalBackup","deleteLocalDraftBackup","loadEntry","getEntry","then","loadedEntry","catch","console","message","details","key","kind","dismissAfter","appendActions","action","addAppendActionsToCursor","updateStore","actions","union","filter","v","has","keySeq","loadEntries","integration","provider","integrations","getToken","isNaN","listEntries","response","usingOldPaginationAPI","data","nextPage","reverse","err","Promise","reject","traverseCursor","Error","traverseCollectionCursor","getIn","toJS","realAction","cursors","newCursor","createEmptyDraft","dataFields","createEmptyDraftData","newEntry","fields","reduce","acc","item","subfields","list","name","defaultValue","List","isList","Map","isMap","persistEntry","entryDraft","fieldsErrors","isEmpty","hasPresenceErrors","some","ValidationErrorTypes","PRESENCE","assetProxies","map","path","serializedData","serializedEntry","set","serializedEntryDraft","deleteEntry"],"mappings":"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","sourcesContent":["import { fromJS, List, Map } from 'immutable';\nimport { actions as notifActions } from 'redux-notifications';\nimport { serializeValues } from 'Lib/serializeEntryValues';\nimport { currentBackend } from 'coreSrc/backend';\nimport { getIntegrationProvider } from 'Integrations';\nimport { getAsset, selectIntegration } from 'Reducers';\nimport { selectFields } from 'Reducers/collections';\nimport { selectCollectionEntriesCursor } from 'Reducers/cursors';\nimport { Cursor } from 'netlify-cms-lib-util';\nimport { createEntry } from 'ValueObjects/Entry';\nimport ValidationErrorTypes from 'Constants/validationErrorTypes';\n\nconst { notifSend } = notifActions;\n\n/*\n * Contant Declarations\n */\nexport const ENTRY_REQUEST = 'ENTRY_REQUEST';\nexport const ENTRY_SUCCESS = 'ENTRY_SUCCESS';\nexport const ENTRY_FAILURE = 'ENTRY_FAILURE';\n\nexport const ENTRIES_REQUEST = 'ENTRIES_REQUEST';\nexport const ENTRIES_SUCCESS = 'ENTRIES_SUCCESS';\nexport const ENTRIES_FAILURE = 'ENTRIES_FAILURE';\n\nexport const DRAFT_CREATE_FROM_ENTRY = 'DRAFT_CREATE_FROM_ENTRY';\nexport const DRAFT_CREATE_EMPTY = 'DRAFT_CREATE_EMPTY';\nexport const DRAFT_DISCARD = 'DRAFT_DISCARD';\nexport const DRAFT_CHANGE = 'DRAFT_CHANGE';\nexport const DRAFT_CHANGE_FIELD = 'DRAFT_CHANGE_FIELD';\nexport const DRAFT_VALIDATION_ERRORS = 'DRAFT_VALIDATION_ERRORS';\nexport const DRAFT_CLEAR_ERRORS = 'DRAFT_CLEAR_ERRORS';\nexport const DRAFT_LOCAL_BACKUP_RETRIEVED = 'DRAFT_LOCAL_BACKUP_RETRIEVED';\nexport const DRAFT_CREATE_FROM_LOCAL_BACKUP = 'DRAFT_CREATE_FROM_LOCAL_BACKUP';\n\nexport const ENTRY_PERSIST_REQUEST = 'ENTRY_PERSIST_REQUEST';\nexport const ENTRY_PERSIST_SUCCESS = 'ENTRY_PERSIST_SUCCESS';\nexport const ENTRY_PERSIST_FAILURE = 'ENTRY_PERSIST_FAILURE';\n\nexport const ENTRY_DELETE_REQUEST = 'ENTRY_DELETE_REQUEST';\nexport const ENTRY_DELETE_SUCCESS = 'ENTRY_DELETE_SUCCESS';\nexport const ENTRY_DELETE_FAILURE = 'ENTRY_DELETE_FAILURE';\n\n/*\n * Simple Action Creators (Internal)\n * We still need to export them for tests\n */\nexport function entryLoading(collection, slug) {\n  return {\n    type: ENTRY_REQUEST,\n    payload: {\n      collection: collection.get('name'),\n      slug,\n    },\n  };\n}\n\nexport function entryLoaded(collection, entry) {\n  return {\n    type: ENTRY_SUCCESS,\n    payload: {\n      collection: collection.get('name'),\n      entry,\n    },\n  };\n}\n\nexport function entryLoadError(error, collection, slug) {\n  return {\n    type: ENTRY_FAILURE,\n    payload: {\n      error,\n      collection: collection.get('name'),\n      slug,\n    },\n  };\n}\n\nexport function entriesLoading(collection) {\n  return {\n    type: ENTRIES_REQUEST,\n    payload: {\n      collection: collection.get('name'),\n    },\n  };\n}\n\nexport function entriesLoaded(collection, entries, pagination, cursor, append = true) {\n  return {\n    type: ENTRIES_SUCCESS,\n    payload: {\n      collection: collection.get('name'),\n      entries,\n      page: pagination,\n      cursor: Cursor.create(cursor),\n      append,\n    },\n  };\n}\n\nexport function entriesFailed(collection, error) {\n  return {\n    type: ENTRIES_FAILURE,\n    error: 'Failed to load entries',\n    payload: error.toString(),\n    meta: { collection: collection.get('name') },\n  };\n}\n\nexport function entryPersisting(collection, entry) {\n  return {\n    type: ENTRY_PERSIST_REQUEST,\n    payload: {\n      collectionName: collection.get('name'),\n      entrySlug: entry.get('slug'),\n    },\n  };\n}\n\nexport function entryPersisted(collection, entry, slug) {\n  return {\n    type: ENTRY_PERSIST_SUCCESS,\n    payload: {\n      collectionName: collection.get('name'),\n      entrySlug: entry.get('slug'),\n\n      /**\n       * Pass slug from backend for newly created entries.\n       */\n      slug,\n    },\n  };\n}\n\nexport function entryPersistFail(collection, entry, error) {\n  return {\n    type: ENTRY_PERSIST_FAILURE,\n    error: 'Failed to persist entry',\n    payload: {\n      collectionName: collection.get('name'),\n      entrySlug: entry.get('slug'),\n      error: error.toString(),\n    },\n  };\n}\n\nexport function entryDeleting(collection, slug) {\n  return {\n    type: ENTRY_DELETE_REQUEST,\n    payload: {\n      collectionName: collection.get('name'),\n      entrySlug: slug,\n    },\n  };\n}\n\nexport function entryDeleted(collection, slug) {\n  return {\n    type: ENTRY_DELETE_SUCCESS,\n    payload: {\n      collectionName: collection.get('name'),\n      entrySlug: slug,\n    },\n  };\n}\n\nexport function entryDeleteFail(collection, slug, error) {\n  return {\n    type: ENTRY_DELETE_FAILURE,\n    payload: {\n      collectionName: collection.get('name'),\n      entrySlug: slug,\n      error: error.toString(),\n    },\n  };\n}\n\nexport function emptyDraftCreated(entry) {\n  return {\n    type: DRAFT_CREATE_EMPTY,\n    payload: entry,\n  };\n}\n/*\n * Exported simple Action Creators\n */\nexport function createDraftFromEntry(entry, metadata) {\n  return {\n    type: DRAFT_CREATE_FROM_ENTRY,\n    payload: { entry, metadata },\n  };\n}\n\nexport function discardDraft() {\n  return {\n    type: DRAFT_DISCARD,\n  };\n}\n\nexport function changeDraft(entry) {\n  return {\n    type: DRAFT_CHANGE,\n    payload: entry,\n  };\n}\n\nexport function changeDraftField(field, value, metadata) {\n  return {\n    type: DRAFT_CHANGE_FIELD,\n    payload: { field, value, metadata },\n  };\n}\n\nexport function changeDraftFieldValidation(uniquefieldId, errors) {\n  return {\n    type: DRAFT_VALIDATION_ERRORS,\n    payload: { uniquefieldId, errors },\n  };\n}\n\nexport function clearFieldErrors() {\n  return { type: DRAFT_CLEAR_ERRORS };\n}\n\nexport function localBackupRetrieved(entry) {\n  return {\n    type: DRAFT_LOCAL_BACKUP_RETRIEVED,\n    payload: { entry },\n  };\n}\n\nexport function loadLocalBackup() {\n  return {\n    type: DRAFT_CREATE_FROM_LOCAL_BACKUP,\n  };\n}\n\nexport function persistLocalBackup(entry, collection) {\n  return (dispatch, getState) => {\n    const state = getState();\n    const backend = currentBackend(state.config);\n    return backend.persistLocalDraftBackup(entry, collection);\n  };\n}\n\nexport function retrieveLocalBackup(collection, slug) {\n  return async (dispatch, getState) => {\n    const state = getState();\n    const backend = currentBackend(state.config);\n    const entry = await backend.getLocalDraftBackup(collection, slug);\n    if (entry) {\n      return dispatch(localBackupRetrieved(entry));\n    }\n  };\n}\n\nexport function deleteLocalBackup(collection, slug) {\n  return (dispatch, getState) => {\n    const state = getState();\n    const backend = currentBackend(state.config);\n    return backend.deleteLocalDraftBackup(collection, slug);\n  };\n}\n\n/*\n * Exported Thunk Action Creators\n */\n\nexport function loadEntry(collection, slug) {\n  return (dispatch, getState) => {\n    const state = getState();\n    const backend = currentBackend(state.config);\n    dispatch(entryLoading(collection, slug));\n    return backend\n      .getEntry(collection, slug)\n      .then(loadedEntry => {\n        return dispatch(entryLoaded(collection, loadedEntry));\n      })\n      .catch(error => {\n        console.error(error);\n        dispatch(\n          notifSend({\n            message: {\n              details: error.message,\n              key: 'ui.toast.onFailToLoadEntries',\n            },\n            kind: 'danger',\n            dismissAfter: 8000,\n          }),\n        );\n        dispatch(entryLoadError(error, collection, slug));\n      });\n  };\n}\n\nconst appendActions = fromJS({\n  ['append_next']: { action: 'next', append: true },\n});\n\nconst addAppendActionsToCursor = cursor =>\n  Cursor.create(cursor).updateStore('actions', actions =>\n    actions.union(appendActions.filter(v => actions.has(v.get('action'))).keySeq()),\n  );\n\nexport function loadEntries(collection, page = 0) {\n  return (dispatch, getState) => {\n    if (collection.get('isFetching')) {\n      return;\n    }\n    const state = getState();\n    const backend = currentBackend(state.config);\n    const integration = selectIntegration(state, collection.get('name'), 'listEntries');\n    const provider = integration\n      ? getIntegrationProvider(state.integrations, backend.getToken, integration)\n      : backend;\n    const append = !!(page && !isNaN(page) && page > 0);\n    dispatch(entriesLoading(collection));\n    provider\n      .listEntries(collection, page)\n      .then(response => ({\n        ...response,\n\n        // The only existing backend using the pagination system is the\n        // Algolia integration, which is also the only integration used\n        // to list entries. Thus, this checking for an integration can\n        // determine whether or not this is using the old integer-based\n        // pagination API. Other backends will simply store an empty\n        // cursor, which behaves identically to no cursor at all.\n        cursor: integration\n          ? Cursor.create({\n              actions: ['next'],\n              meta: { usingOldPaginationAPI: true },\n              data: { nextPage: page + 1 },\n            })\n          : Cursor.create(response.cursor),\n      }))\n      .then(response =>\n        dispatch(\n          entriesLoaded(\n            collection,\n            response.cursor.meta.get('usingOldPaginationAPI')\n              ? response.entries.reverse()\n              : response.entries,\n            response.pagination,\n            addAppendActionsToCursor(response.cursor),\n            append,\n          ),\n        ),\n      )\n      .catch(err => {\n        dispatch(\n          notifSend({\n            message: {\n              details: err,\n              key: 'ui.toast.onFailToLoadEntries',\n            },\n            kind: 'danger',\n            dismissAfter: 8000,\n          }),\n        );\n        return Promise.reject(dispatch(entriesFailed(collection, err)));\n      });\n  };\n}\n\nfunction traverseCursor(backend, cursor, action) {\n  if (!cursor.actions.has(action)) {\n    throw new Error(`The current cursor does not support the pagination action \"${action}\".`);\n  }\n  return backend.traverseCursor(cursor, action);\n}\n\nexport function traverseCollectionCursor(collection, action) {\n  return async (dispatch, getState) => {\n    const state = getState();\n    if (state.entries.getIn(['pages', `${collection.get('name')}`, 'isFetching'])) {\n      return;\n    }\n    const backend = currentBackend(state.config);\n\n    const { action: realAction, append } = appendActions.has(action)\n      ? appendActions.get(action).toJS()\n      : { action, append: false };\n    const cursor = selectCollectionEntriesCursor(state.cursors, collection.get('name'));\n\n    // Handle cursors representing pages in the old, integer-based\n    // pagination API\n    if (cursor.meta.get('usingOldPaginationAPI', false)) {\n      return dispatch(loadEntries(collection, cursor.data.get('nextPage')));\n    }\n\n    try {\n      dispatch(entriesLoading(collection));\n      const { entries, cursor: newCursor } = await traverseCursor(backend, cursor, realAction);\n      // Pass null for the old pagination argument - this will\n      // eventually be removed.\n      return dispatch(\n        entriesLoaded(collection, entries, null, addAppendActionsToCursor(newCursor), append),\n      );\n    } catch (err) {\n      console.error(err);\n      dispatch(\n        notifSend({\n          message: {\n            details: err,\n            key: 'ui.toast.onFailToPersist',\n          },\n          kind: 'danger',\n          dismissAfter: 8000,\n        }),\n      );\n      return Promise.reject(dispatch(entriesFailed(collection, err)));\n    }\n  };\n}\n\nexport function createEmptyDraft(collection) {\n  return dispatch => {\n    const dataFields = createEmptyDraftData(collection.get('fields', List()));\n    const newEntry = createEntry(collection.get('name'), '', '', { data: dataFields });\n    dispatch(emptyDraftCreated(newEntry));\n  };\n}\n\nfunction createEmptyDraftData(fields) {\n  return fields.reduce((acc, item) => {\n    const subfields = item.get('field') || item.get('fields');\n    const list = item.get('widget') == 'list';\n    const name = item.get('name');\n    const defaultValue = item.get('default', null);\n\n    if (List.isList(subfields)) {\n      acc[name] = list ? [createEmptyDraftData(subfields)] : createEmptyDraftData(subfields);\n      return acc;\n    }\n\n    if (Map.isMap(subfields)) {\n      acc[name] = list ? [createEmptyDraftData([subfields])] : createEmptyDraftData([subfields]);\n      return acc;\n    }\n\n    if (defaultValue !== null) {\n      acc[name] = defaultValue;\n    }\n\n    return acc;\n  }, {});\n}\n\nexport function persistEntry(collection) {\n  return (dispatch, getState) => {\n    const state = getState();\n    const entryDraft = state.entryDraft;\n    const fieldsErrors = entryDraft.get('fieldsErrors');\n\n    // Early return if draft contains validation errors\n    if (!fieldsErrors.isEmpty()) {\n      const hasPresenceErrors = fieldsErrors.some(errors =>\n        errors.some(error => error.type && error.type === ValidationErrorTypes.PRESENCE),\n      );\n\n      if (hasPresenceErrors) {\n        dispatch(\n          notifSend({\n            message: {\n              key: 'ui.toast.missingRequiredField',\n            },\n            kind: 'danger',\n            dismissAfter: 8000,\n          }),\n        );\n      }\n\n      return Promise.reject();\n    }\n\n    const backend = currentBackend(state.config);\n    const assetProxies = entryDraft.get('mediaFiles').map(path => getAsset(state, path));\n    const entry = entryDraft.get('entry');\n\n    /**\n     * Serialize the values of any fields with registered serializers, and\n     * update the entry and entryDraft with the serialized values.\n     */\n    const fields = selectFields(collection, entry.get('slug'));\n    const serializedData = serializeValues(entryDraft.getIn(['entry', 'data']), fields);\n    const serializedEntry = entry.set('data', serializedData);\n    const serializedEntryDraft = entryDraft.set('entry', serializedEntry);\n    dispatch(entryPersisting(collection, serializedEntry));\n    return backend\n      .persistEntry(state.config, collection, serializedEntryDraft, assetProxies.toJS())\n      .then(slug => {\n        dispatch(\n          notifSend({\n            message: {\n              key: 'ui.toast.entrySaved',\n            },\n            kind: 'success',\n            dismissAfter: 4000,\n          }),\n        );\n        dispatch(entryPersisted(collection, serializedEntry, slug));\n      })\n      .catch(error => {\n        console.error(error);\n        dispatch(\n          notifSend({\n            message: {\n              details: error,\n              key: 'ui.toast.onFailToPersist',\n            },\n            kind: 'danger',\n            dismissAfter: 8000,\n          }),\n        );\n        return Promise.reject(dispatch(entryPersistFail(collection, serializedEntry, error)));\n      });\n  };\n}\n\nexport function deleteEntry(collection, slug) {\n  return (dispatch, getState) => {\n    const state = getState();\n    const backend = currentBackend(state.config);\n\n    dispatch(entryDeleting(collection, slug));\n    return backend\n      .deleteEntry(state.config, collection, slug)\n      .then(() => {\n        return dispatch(entryDeleted(collection, slug));\n      })\n      .catch(error => {\n        dispatch(\n          notifSend({\n            message: {\n              details: error,\n              key: 'ui.toast.onFailToDelete',\n            },\n            kind: 'danger',\n            dismissAfter: 8000,\n          }),\n        );\n        console.error(error);\n        return Promise.reject(dispatch(entryDeleteFail(collection, slug, error)));\n      });\n  };\n}\n"],"file":"entries.js"}