{"version":3,"sources":["../../../../src/components/Editor/withWorkflow.js"],"names":["mapStateToProps","state","ownProps","collections","isEditorialWorkflow","config","get","EDITORIAL_WORKFLOW","collection","match","params","name","returnObj","showDelete","newEntry","slug","unpublishedEntry","entry","mergeProps","stateProps","dispatchProps","dispatch","loadEntry","persistEntry","withWorkflow","Editor","WorkflowEditor","React","Component","render","props"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;AAEA,SAASA,eAAT,CAAyBC,KAAzB,EAAgCC,QAAhC,EAA0C;AAAA,QAChCC,WADgC,GAChBF,KADgB,CAChCE,WADgC;;AAExC,QAAMC,mBAAmB,GAAGH,KAAK,CAACI,MAAN,CAAaC,GAAb,CAAiB,cAAjB,MAAqCC,gCAAjE;;AACA,QAAMC,UAAU,GAAGL,WAAW,CAACG,GAAZ,CAAgBJ,QAAQ,CAACO,KAAT,CAAeC,MAAf,CAAsBC,IAAtC,CAAnB;AACA,QAAMC,SAAS,GAAG;AAChBR,IAAAA,mBADgB;AAEhBS,IAAAA,UAAU,EAAE,CAACX,QAAQ,CAACY,QAAV,IAAsB,sCAAoBN,UAApB;AAFlB,GAAlB;;AAIA,MAAIJ,mBAAJ,EAAyB;AACvB,UAAMW,IAAI,GAAGb,QAAQ,CAACO,KAAT,CAAeC,MAAf,CAAsBK,IAAnC;AACA,UAAMC,gBAAgB,GAAG,sCAAuBf,KAAvB,EAA8BO,UAAU,CAACF,GAAX,CAAe,MAAf,CAA9B,EAAsDS,IAAtD,CAAzB;;AACA,QAAIC,gBAAJ,EAAsB;AACpBJ,MAAAA,SAAS,CAACI,gBAAV,GAA6B,IAA7B;AACAJ,MAAAA,SAAS,CAACK,KAAV,GAAkBD,gBAAlB;AACD;AACF;;AACD,SAAOJ,SAAP;AACD;;AAED,SAASM,UAAT,CAAoBC,UAApB,EAAgCC,aAAhC,EAA+ClB,QAA/C,EAAyD;AAAA,QAC/CE,mBAD+C,GACLe,UADK,CAC/Cf,mBAD+C;AAAA,QAC1BY,gBAD0B,GACLG,UADK,CAC1BH,gBAD0B;AAAA,QAE/CK,QAF+C,GAElCD,aAFkC,CAE/CC,QAF+C;AAGvD,QAAMT,SAAS,GAAG,EAAlB;;AAEA,MAAIR,mBAAJ,EAAyB;AACvB;AACAQ,IAAAA,SAAS,CAACU,SAAV,GAAsB,CAACd,UAAD,EAAaO,IAAb,KAAsBM,QAAQ,CAAC,6CAAqBb,UAArB,EAAiCO,IAAjC,CAAD,CAApD,CAFuB,CAIvB;;;AACAH,IAAAA,SAAS,CAACW,YAAV,GAAyBf,UAAU,IACjCa,QAAQ,CAAC,gDAAwBb,UAAxB,EAAoCQ,gBAApC,CAAD,CADV;AAED;;AAED,2BACKd,QADL,EAEKiB,UAFL,EAGKP,SAHL;AAKD;;AAEc,SAASY,YAAT,CAAsBC,MAAtB,EAA8B;AAC3C,SAAO,yBACLzB,eADK,EAEL,IAFK,EAGLkB,UAHK,EAKL,MAAMQ,cAAN,SAA6BC,eAAMC,SAAnC,CAA6C;AAC3CC,IAAAA,MAAM,GAAG;AACP,aAAO,6BAAC,MAAD,EAAY,KAAKC,KAAjB,CAAP;AACD;;AAH0C,GALxC,CAAP;AAWD","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport { EDITORIAL_WORKFLOW } from 'Constants/publishModes';\nimport { selectUnpublishedEntry } from 'Reducers';\nimport { selectAllowDeletion } from 'Reducers/collections';\nimport { loadUnpublishedEntry, persistUnpublishedEntry } from 'Actions/editorialWorkflow';\n\nfunction mapStateToProps(state, ownProps) {\n  const { collections } = state;\n  const isEditorialWorkflow = state.config.get('publish_mode') === EDITORIAL_WORKFLOW;\n  const collection = collections.get(ownProps.match.params.name);\n  const returnObj = {\n    isEditorialWorkflow,\n    showDelete: !ownProps.newEntry && selectAllowDeletion(collection),\n  };\n  if (isEditorialWorkflow) {\n    const slug = ownProps.match.params.slug;\n    const unpublishedEntry = selectUnpublishedEntry(state, collection.get('name'), slug);\n    if (unpublishedEntry) {\n      returnObj.unpublishedEntry = true;\n      returnObj.entry = unpublishedEntry;\n    }\n  }\n  return returnObj;\n}\n\nfunction mergeProps(stateProps, dispatchProps, ownProps) {\n  const { isEditorialWorkflow, unpublishedEntry } = stateProps;\n  const { dispatch } = dispatchProps;\n  const returnObj = {};\n\n  if (isEditorialWorkflow) {\n    // Overwrite loadEntry to loadUnpublishedEntry\n    returnObj.loadEntry = (collection, slug) => dispatch(loadUnpublishedEntry(collection, slug));\n\n    // Overwrite persistEntry to persistUnpublishedEntry\n    returnObj.persistEntry = collection =>\n      dispatch(persistUnpublishedEntry(collection, unpublishedEntry));\n  }\n\n  return {\n    ...ownProps,\n    ...stateProps,\n    ...returnObj,\n  };\n}\n\nexport default function withWorkflow(Editor) {\n  return connect(\n    mapStateToProps,\n    null,\n    mergeProps,\n  )(\n    class WorkflowEditor extends React.Component {\n      render() {\n        return <Editor {...this.props} />;\n      }\n    },\n  );\n}\n"],"file":"withWorkflow.js"}