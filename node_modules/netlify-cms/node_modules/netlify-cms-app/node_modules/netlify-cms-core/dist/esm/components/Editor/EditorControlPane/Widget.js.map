{"version":3,"sources":["../../../../../src/components/Editor/EditorControlPane/Widget.js"],"names":["truthy","error","isEmpty","value","undefined","hasOwnProperty","length","constructor","Object","keys","List","isList","size","Widget","Component","ref","innerWrappedControl","getWrappedInstance","wrappedControlValid","isValid","scu","shouldComponentUpdate","wrappedControlShouldComponentUpdate","bind","skipWrapped","props","field","errors","validations","validatePresence","validatePattern","forEach","func","response","push","wrappedError","validateWrappedControl","onValidate","t","isRequired","get","type","ValidationErrorTypes","PRESENCE","message","fieldLabel","pattern","RegExp","first","test","PATTERN","last","Promise","then","validate","err","CUSTOM","fieldName","newValue","newMetadata","newObjectValue","getObjectValue","set","onChange","nextProps","classNameWrapper","hasActiveStyle","render","controlComponent","mediaPaths","metadata","onValidateObject","onOpenMediaLibrary","onRemoveMediaControl","onClearMediaControl","onAddAsset","onRemoveInsertedMedia","getAsset","classNameWidget","classNameWidgetActive","classNameLabel","classNameLabelActive","setActiveStyle","setInactiveStyle","editorControl","uniqueFieldId","resolveWidget","getEditorComponents","query","queryHits","clearSearch","clearFieldErrors","isFetching","loadEntry","fieldsErrors","controlRef","React","createElement","onChangeObject","forID","processInnerControlRef","PropTypes","ImmutablePropTypes","map","bool","string","oneOfType","node","object","array"],"mappings":"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","sourcesContent":["import PropTypes from 'prop-types';\nimport React, { Component } from 'react';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport { Map, List } from 'immutable';\nimport ValidationErrorTypes from 'Constants/validationErrorTypes';\n\nconst truthy = () => ({ error: false });\n\nconst isEmpty = value =>\n  value === null ||\n  value === undefined ||\n  (value.hasOwnProperty('length') && value.length === 0) ||\n  (value.constructor === Object && Object.keys(value).length === 0) ||\n  (List.isList(value) && value.size === 0);\n\nexport default class Widget extends Component {\n  static propTypes = {\n    controlComponent: PropTypes.func.isRequired,\n    field: ImmutablePropTypes.map.isRequired,\n    hasActiveStyle: PropTypes.bool,\n    setActiveStyle: PropTypes.func.isRequired,\n    setInactiveStyle: PropTypes.func.isRequired,\n    classNameWrapper: PropTypes.string.isRequired,\n    classNameWidget: PropTypes.string.isRequired,\n    classNameWidgetActive: PropTypes.string.isRequired,\n    classNameLabel: PropTypes.string.isRequired,\n    classNameLabelActive: PropTypes.string.isRequired,\n    value: PropTypes.oneOfType([\n      PropTypes.node,\n      PropTypes.object,\n      PropTypes.string,\n      PropTypes.bool,\n    ]),\n    mediaPaths: ImmutablePropTypes.map.isRequired,\n    metadata: ImmutablePropTypes.map,\n    fieldsErrors: ImmutablePropTypes.map,\n    onChange: PropTypes.func.isRequired,\n    onValidate: PropTypes.func,\n    onOpenMediaLibrary: PropTypes.func.isRequired,\n    onClearMediaControl: PropTypes.func.isRequired,\n    onRemoveMediaControl: PropTypes.func.isRequired,\n    onAddAsset: PropTypes.func.isRequired,\n    onRemoveInsertedMedia: PropTypes.func.isRequired,\n    getAsset: PropTypes.func.isRequired,\n    resolveWidget: PropTypes.func.isRequired,\n    getEditorComponents: PropTypes.func.isRequired,\n    isFetching: PropTypes.bool,\n    controlRef: PropTypes.func,\n    query: PropTypes.func.isRequired,\n    clearSearch: PropTypes.func.isRequired,\n    clearFieldErrors: PropTypes.func.isRequired,\n    queryHits: PropTypes.oneOfType([PropTypes.array, PropTypes.object]),\n    editorControl: PropTypes.func.isRequired,\n    uniqueFieldId: PropTypes.string.isRequired,\n    loadEntry: PropTypes.func.isRequired,\n    t: PropTypes.func.isRequired,\n  };\n\n  shouldComponentUpdate(nextProps) {\n    /**\n     * Allow widgets to provide their own `shouldComponentUpdate` method.\n     */\n    if (this.wrappedControlShouldComponentUpdate) {\n      return this.wrappedControlShouldComponentUpdate(nextProps);\n    }\n    return (\n      this.props.value !== nextProps.value ||\n      this.props.classNameWrapper !== nextProps.classNameWrapper ||\n      this.props.hasActiveStyle !== nextProps.hasActiveStyle\n    );\n  }\n\n  processInnerControlRef = ref => {\n    if (!ref) return;\n\n    /**\n     * If the widget is a container that receives state updates from the store,\n     * we'll need to get the ref of the actual control via the `react-redux`\n     * `getWrappedInstance` method. Note that connected widgets must pass\n     * `withRef: true` to `connect` in the options object.\n     */\n    this.innerWrappedControl = ref.getWrappedInstance ? ref.getWrappedInstance() : ref;\n\n    this.wrappedControlValid = this.innerWrappedControl.isValid || truthy;\n\n    /**\n     * Get the `shouldComponentUpdate` method from the wrapped control, and\n     * provide the control instance is the `this` binding.\n     */\n    const { shouldComponentUpdate: scu } = this.innerWrappedControl;\n    this.wrappedControlShouldComponentUpdate = scu && scu.bind(this.innerWrappedControl);\n  };\n\n  validate = (skipWrapped = false) => {\n    const { field, value } = this.props;\n    const errors = [];\n    const validations = [this.validatePresence, this.validatePattern];\n    validations.forEach(func => {\n      const response = func(field, value);\n      if (response.error) errors.push(response.error);\n    });\n    if (skipWrapped) {\n      if (skipWrapped.error) errors.push(skipWrapped.error);\n    } else {\n      const wrappedError = this.validateWrappedControl(field);\n      if (wrappedError.error) errors.push(wrappedError.error);\n    }\n    this.props.onValidate(errors);\n  };\n\n  validatePresence = (field, value) => {\n    const t = this.props.t;\n    const isRequired = field.get('required', true);\n    if (isRequired && isEmpty(value)) {\n      const error = {\n        type: ValidationErrorTypes.PRESENCE,\n        message: t('editor.editorControlPane.widget.required', {\n          fieldLabel: field.get('label', field.get('name')),\n        }),\n      };\n\n      return { error };\n    }\n    return { error: false };\n  };\n\n  validatePattern = (field, value) => {\n    const t = this.props.t;\n    const pattern = field.get('pattern', false);\n\n    if (isEmpty(value)) {\n      return { error: false };\n    }\n\n    if (pattern && !RegExp(pattern.first()).test(value)) {\n      const error = {\n        type: ValidationErrorTypes.PATTERN,\n        message: t('editor.editorControlPane.widget.regexPattern', {\n          fieldLabel: field.get('label', field.get('name')),\n          pattern: pattern.last(),\n        }),\n      };\n\n      return { error };\n    }\n\n    return { error: false };\n  };\n\n  validateWrappedControl = field => {\n    const t = this.props.t;\n    const response = this.wrappedControlValid();\n    if (typeof response === 'boolean') {\n      const isValid = response;\n      return { error: !isValid };\n    } else if (response.hasOwnProperty('error')) {\n      return response;\n    } else if (response instanceof Promise) {\n      response.then(\n        () => {\n          this.validate({ error: false });\n        },\n        err => {\n          const error = {\n            type: ValidationErrorTypes.CUSTOM,\n            message: `${field.get('label', field.get('name'))} - ${err}.`,\n          };\n\n          this.validate({ error });\n        },\n      );\n\n      const error = {\n        type: ValidationErrorTypes.CUSTOM,\n        message: t('editor.editorControlPane.widget.processing', {\n          fieldLabel: field.get('label', field.get('name')),\n        }),\n      };\n\n      return { error };\n    }\n    return { error: false };\n  };\n\n  /**\n   * In case the `onChangeObject` function is frozen by a child widget implementation,\n   * e.g. when debounced, always get the latest object value instead of using\n   * `this.props.value` directly.\n   */\n  getObjectValue = () => this.props.value || Map();\n\n  /**\n   * Change handler for fields that are nested within another field.\n   */\n  onChangeObject = (fieldName, newValue, newMetadata) => {\n    const newObjectValue = this.getObjectValue().set(fieldName, newValue);\n    return this.props.onChange(\n      newObjectValue,\n      newMetadata && { [this.props.field.get('name')]: newMetadata },\n    );\n  };\n\n  render() {\n    const {\n      controlComponent,\n      field,\n      value,\n      mediaPaths,\n      metadata,\n      onChange,\n      onValidateObject,\n      onOpenMediaLibrary,\n      onRemoveMediaControl,\n      onClearMediaControl,\n      onAddAsset,\n      onRemoveInsertedMedia,\n      getAsset,\n      classNameWrapper,\n      classNameWidget,\n      classNameWidgetActive,\n      classNameLabel,\n      classNameLabelActive,\n      setActiveStyle,\n      setInactiveStyle,\n      hasActiveStyle,\n      editorControl,\n      uniqueFieldId,\n      resolveWidget,\n      getEditorComponents,\n      query,\n      queryHits,\n      clearSearch,\n      clearFieldErrors,\n      isFetching,\n      loadEntry,\n      fieldsErrors,\n      controlRef,\n      t,\n    } = this.props;\n    return React.createElement(controlComponent, {\n      field,\n      value,\n      mediaPaths,\n      metadata,\n      onChange,\n      onChangeObject: this.onChangeObject,\n      onValidateObject,\n      onOpenMediaLibrary,\n      onClearMediaControl,\n      onRemoveMediaControl,\n      onAddAsset,\n      onRemoveInsertedMedia,\n      getAsset,\n      forID: uniqueFieldId,\n      ref: this.processInnerControlRef,\n      classNameWrapper,\n      classNameWidget,\n      classNameWidgetActive,\n      classNameLabel,\n      classNameLabelActive,\n      setActiveStyle,\n      setInactiveStyle,\n      hasActiveStyle,\n      editorControl,\n      resolveWidget,\n      getEditorComponents,\n      query,\n      queryHits,\n      clearSearch,\n      clearFieldErrors,\n      isFetching,\n      loadEntry,\n      fieldsErrors,\n      controlRef,\n      t,\n    });\n  }\n}\n"],"file":"Widget.js"}