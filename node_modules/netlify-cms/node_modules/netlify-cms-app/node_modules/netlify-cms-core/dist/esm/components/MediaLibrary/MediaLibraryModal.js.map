{"version":3,"sources":["../../../../src/components/MediaLibrary/MediaLibraryModal.js"],"names":["cardWidth","cardMargin","cardOutsideWidth","LibraryTop","StyledModal","Modal","props","isPrivate","colors","grayDark","textFieldBorder","MediaLibraryModal","isVisible","canInsert","files","dynamicSearch","dynamicSearchActive","forImage","isLoading","isPersisting","isDeleting","hasNextPage","isPaginating","privateUpload","query","selectedFile","handleFilter","handleQuery","toTableData","handleClose","handleSearchChange","handleSearchKeyDown","handlePersist","handleDelete","handleInsert","setScrollContainerRef","handleAssetClick","handleLoadMore","loadDisplayURL","displayURLs","t","filteredFiles","queriedFiles","tableData","hasFiles","length","hasFilteredFiles","hasSearchResults","hasMedia","shouldShowEmptyMessage","emptyMessage","hasSelection","shouldShowButtonLoader","file","key","fileShape","displayURL","PropTypes","oneOfType","string","object","isRequired","id","name","queryOrder","number","size","url","urlIsPublicPath","bool","propTypes","arrayOf","shape","func"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from '@emotion/styled';\nimport { isEmpty } from 'lodash';\nimport { translate } from 'react-polyglot';\nimport { Modal } from 'UI';\nimport MediaLibrarySearch from './MediaLibrarySearch';\nimport MediaLibraryHeader from './MediaLibraryHeader';\nimport MediaLibraryActions from './MediaLibraryActions';\nimport MediaLibraryCardGrid from './MediaLibraryCardGrid';\nimport EmptyMessage from './EmptyMessage';\nimport { colors } from 'netlify-cms-ui-default';\n\n/**\n * Responsive styling needs to be overhauled. Current setup requires specifying\n * widths per breakpoint.\n */\nconst cardWidth = `280px`;\nconst cardMargin = `10px`;\n\n/**\n * cardWidth + cardMargin * 2 = cardOutsideWidth\n * (not using calc because this will be nested in other calcs)\n */\nconst cardOutsideWidth = `300px`;\n\nconst LibraryTop = styled.div`\n  position: relative;\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst StyledModal = styled(Modal)`\n  display: grid;\n  grid-template-rows: 120px auto;\n  width: calc(${cardOutsideWidth} + 20px);\n  background-color: ${props => props.isPrivate && colors.grayDark};\n\n  @media (min-width: 800px) {\n    width: calc(${cardOutsideWidth} * 2 + 20px);\n  }\n\n  @media (min-width: 1120px) {\n    width: calc(${cardOutsideWidth} * 3 + 20px);\n  }\n\n  @media (min-width: 1440px) {\n    width: calc(${cardOutsideWidth} * 4 + 20px);\n  }\n\n  @media (min-width: 1760px) {\n    width: calc(${cardOutsideWidth} * 5 + 20px);\n  }\n\n  @media (min-width: 2080px) {\n    width: calc(${cardOutsideWidth} * 6 + 20px);\n  }\n\n  h1 {\n    color: ${props => props.isPrivate && colors.textFieldBorder};\n  }\n\n  button:disabled,\n  label[disabled] {\n    background-color: ${props => props.isPrivate && `rgba(217, 217, 217, 0.15)`};\n  }\n`;\n\nconst MediaLibraryModal = ({\n  isVisible,\n  canInsert,\n  files,\n  dynamicSearch,\n  dynamicSearchActive,\n  forImage,\n  isLoading,\n  isPersisting,\n  isDeleting,\n  hasNextPage,\n  isPaginating,\n  privateUpload,\n  query,\n  selectedFile,\n  handleFilter,\n  handleQuery,\n  toTableData,\n  handleClose,\n  handleSearchChange,\n  handleSearchKeyDown,\n  handlePersist,\n  handleDelete,\n  handleInsert,\n  setScrollContainerRef,\n  handleAssetClick,\n  handleLoadMore,\n  loadDisplayURL,\n  displayURLs,\n  t,\n}) => {\n  const filteredFiles = forImage ? handleFilter(files) : files;\n  const queriedFiles = !dynamicSearch && query ? handleQuery(query, filteredFiles) : filteredFiles;\n  const tableData = toTableData(queriedFiles);\n  const hasFiles = files && !!files.length;\n  const hasFilteredFiles = filteredFiles && !!filteredFiles.length;\n  const hasSearchResults = queriedFiles && !!queriedFiles.length;\n  const hasMedia = hasSearchResults;\n  const shouldShowEmptyMessage = !hasMedia;\n  const emptyMessage =\n    (isLoading && !hasMedia && t('mediaLibrary.mediaLibraryModal.loading')) ||\n    (dynamicSearchActive && t('mediaLibrary.mediaLibraryModal.noResults')) ||\n    (!hasFiles && t('mediaLibrary.mediaLibraryModal.noAssetsFound')) ||\n    (!hasFilteredFiles && t('mediaLibrary.mediaLibraryModal.noImagesFound')) ||\n    (!hasSearchResults && t('mediaLibrary.mediaLibraryModal.noResults'));\n  const hasSelection = hasMedia && !isEmpty(selectedFile);\n  const shouldShowButtonLoader = isPersisting || isDeleting;\n\n  return (\n    <StyledModal isOpen={isVisible} onClose={handleClose} isPrivate={privateUpload}>\n      <LibraryTop>\n        <div>\n          <MediaLibraryHeader\n            onClose={handleClose}\n            title={`${privateUpload ? t('mediaLibrary.mediaLibraryModal.private') : ''}${\n              forImage\n                ? t('mediaLibrary.mediaLibraryModal.images')\n                : t('mediaLibrary.mediaLibraryModal.mediaAssets')\n            }`}\n            isPrivate={privateUpload}\n          />\n          <MediaLibrarySearch\n            value={query}\n            onChange={handleSearchChange}\n            onKeyDown={handleSearchKeyDown}\n            placeholder={t('mediaLibrary.mediaLibraryModal.search')}\n            disabled={!dynamicSearchActive && !hasFilteredFiles}\n          />\n        </div>\n        <MediaLibraryActions\n          uploadButtonLabel={\n            isPersisting\n              ? t('mediaLibrary.mediaLibraryModal.uploading')\n              : t('mediaLibrary.mediaLibraryModal.uploadNew')\n          }\n          deleteButtonLabel={\n            isDeleting\n              ? t('mediaLibrary.mediaLibraryModal.deleting')\n              : t('mediaLibrary.mediaLibraryModal.deleteSelected')\n          }\n          insertButtonLabel={t('mediaLibrary.mediaLibraryModal.chooseSelected')}\n          uploadEnabled={!shouldShowButtonLoader}\n          deleteEnabled={!shouldShowButtonLoader && hasSelection}\n          insertEnabled={hasSelection}\n          insertVisible={canInsert}\n          imagesOnly={forImage}\n          onPersist={handlePersist}\n          onDelete={handleDelete}\n          onInsert={handleInsert}\n        />\n      </LibraryTop>\n      {!shouldShowEmptyMessage ? null : (\n        <EmptyMessage content={emptyMessage} isPrivate={privateUpload} />\n      )}\n      <MediaLibraryCardGrid\n        setScrollContainerRef={setScrollContainerRef}\n        mediaItems={tableData}\n        isSelectedFile={file => selectedFile.key === file.key}\n        onAssetClick={handleAssetClick}\n        canLoadMore={hasNextPage}\n        onLoadMore={handleLoadMore}\n        isPaginating={isPaginating}\n        paginatingMessage={t('mediaLibrary.mediaLibraryModal.loading')}\n        cardWidth={cardWidth}\n        cardMargin={cardMargin}\n        isPrivate={privateUpload}\n        loadDisplayURL={loadDisplayURL}\n        displayURLs={displayURLs}\n      />\n    </StyledModal>\n  );\n};\n\nconst fileShape = {\n  displayURL: PropTypes.oneOfType([PropTypes.string, PropTypes.object]).isRequired,\n  id: PropTypes.string.isRequired,\n  key: PropTypes.string.isRequired,\n  name: PropTypes.string.isRequired,\n  queryOrder: PropTypes.number,\n  size: PropTypes.number,\n  url: PropTypes.string,\n  urlIsPublicPath: PropTypes.bool,\n};\n\nMediaLibraryModal.propTypes = {\n  isVisible: PropTypes.bool,\n  canInsert: PropTypes.bool,\n  files: PropTypes.arrayOf(PropTypes.shape(fileShape)).isRequired,\n  dynamicSearch: PropTypes.bool,\n  dynamicSearchActive: PropTypes.bool,\n  forImage: PropTypes.bool,\n  isLoading: PropTypes.bool,\n  isPersisting: PropTypes.bool,\n  isDeleting: PropTypes.bool,\n  hasNextPage: PropTypes.bool,\n  isPaginating: PropTypes.bool,\n  privateUpload: PropTypes.bool,\n  query: PropTypes.string,\n  selectedFile: PropTypes.oneOfType([PropTypes.shape(fileShape), PropTypes.shape({})]),\n  handleFilter: PropTypes.func.isRequired,\n  handleQuery: PropTypes.func.isRequired,\n  toTableData: PropTypes.func.isRequired,\n  handleClose: PropTypes.func.isRequired,\n  handleSearchChange: PropTypes.func.isRequired,\n  handleSearchKeyDown: PropTypes.func.isRequired,\n  handlePersist: PropTypes.func.isRequired,\n  handleDelete: PropTypes.func.isRequired,\n  handleInsert: PropTypes.func.isRequired,\n  setScrollContainerRef: PropTypes.func.isRequired,\n  handleAssetClick: PropTypes.func.isRequired,\n  handleLoadMore: PropTypes.func.isRequired,\n  loadDisplayURL: PropTypes.func.isRequired,\n  t: PropTypes.func.isRequired,\n};\n\nexport default translate()(MediaLibraryModal);\n"],"file":"MediaLibraryModal.js"}