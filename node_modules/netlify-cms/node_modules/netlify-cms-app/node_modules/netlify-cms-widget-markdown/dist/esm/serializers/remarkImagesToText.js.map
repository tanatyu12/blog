{"version":3,"sources":["../../../src/serializers/remarkImagesToText.js"],"names":["remarkImagesToText","transform","node","children","map","child","type","length","alt","url","title","value"],"mappings":";;;;;;;;;;;AAAA;;;;;;;AAOe,SAASA,kBAAT,GAA8B;AAC3C,SAAOC,SAAP;;AAEA,WAASA,SAAT,CAAmBC,IAAnB,EAAyB;AACvB,UAAMC,QAAQ,GAAGD,IAAI,CAACC,QAAL,CAAcC,GAAd,CAAkBC,KAAK,IAAI;AAC1C,UACEA,KAAK,CAACC,IAAN,KAAe,WAAf,IACAD,KAAK,CAACF,QAAN,CAAeI,MAAf,KAA0B,CAD1B,IAEAF,KAAK,CAACF,QAAN,CAAe,CAAf,EAAkBG,IAAlB,KAA2B,OAH7B,EAIE;AAAA,iCAC4BD,KAAK,CAACF,QAAN,CAAe,CAAf,CAD5B;AAAA,cACQK,GADR,oBACQA,GADR;AAAA,cACaC,GADb,oBACaA,GADb;AAAA,cACkBC,KADlB,oBACkBA,KADlB;AAEA,cAAMC,KAAK,GAAI,KAAIH,GAAG,IAAI,EAAG,KAAIC,GAAG,IAAI,EAAG,GAAEC,KAAK,GAAI,KAAIA,KAAM,GAAd,GAAmB,EAAG,GAAxE;AACAL,QAAAA,KAAK,CAACF,QAAN,GAAiB,CAAC;AAAEG,UAAAA,IAAI,EAAE,MAAR;AAAgBK,UAAAA;AAAhB,SAAD,CAAjB;AACD;;AACD,aAAON,KAAP;AACD,KAXgB,CAAjB;AAYA,6BAAYH,IAAZ;AAAkBC,MAAAA;AAAlB;AACD;AACF","sourcesContent":["/**\n * Images must be parsed as shortcodes for asset proxying. This plugin converts\n * MDAST image nodes back to text to allow shortcode pattern matching. Note that\n * this transformation only occurs for images that are the sole child of a top\n * level paragraph - any other image is left alone and treated as an inline\n * image.\n */\nexport default function remarkImagesToText() {\n  return transform;\n\n  function transform(node) {\n    const children = node.children.map(child => {\n      if (\n        child.type === 'paragraph' &&\n        child.children.length === 1 &&\n        child.children[0].type === 'image'\n      ) {\n        const { alt, url, title } = child.children[0];\n        const value = `![${alt || ''}](${url || ''}${title ? ` \"${title}\"` : ''})`;\n        child.children = [{ type: 'text', value }];\n      }\n      return child;\n    });\n    return { ...node, children };\n  }\n}\n"],"file":"remarkImagesToText.js"}